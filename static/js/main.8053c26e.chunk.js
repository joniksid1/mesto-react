(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{11:function(e,t,n){e.exports=n(20)},20:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),i=n.n(r),c=(n(7),n(10)),l=n(1),u=n(9),s=n.n(u);var p=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{src:s.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u043c\u0435\u0441\u0442\u043e, \u0420\u043e\u0441\u0441\u0438\u044f",className:"header__logo"}))},m=o.a.createContext();var _=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,r=e.onDeletePopup,i=e.onSelectDeleteCard,c=e.onImageOpen,l=o.a.useContext(m),u=t.owner._id===l._id,s=t.likes.some((function(e){return e._id===l._id})),p="elements__heart ".concat(s&&"elements__heart_active");return o.a.createElement("li",{className:"elements__list-item"},o.a.createElement("img",{alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0435",className:"elements__image",src:t.link,onClick:function(){n(t),c()}}),u&&o.a.createElement("button",{className:"elements__delete",onClick:function(){r(),i(t)}}),o.a.createElement("div",{className:"elements__caption"},o.a.createElement("h2",{className:"elements__title"},t.name),o.a.createElement("div",{className:"elements__like-wrapper"},o.a.createElement("button",{className:p,onClick:function(){a(t)},type:"button"}),o.a.createElement("p",{className:"elements__like-counter"},t.likes.length))))},d=o.a.createContext();var f=function(e){var t=e.onEditProfile,n=e.onAddPlace,a=e.onEditAvatar,r=e.onDeletePopup,i=e.onSelectDeleteCard,c=e.onImageOpen,l=e.onCardClick,u=e.onCardLike,s=o.a.useContext(m),p=s.name,f=s.about,h=s.avatar,v=o.a.useContext(d);return o.a.createElement("main",{className:"main"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__image-overlay"},o.a.createElement("img",{src:h,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",className:"profile__image",onClick:a})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("h1",{className:"profile__title","aria-label":"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"},p),o.a.createElement("button",{className:"profile__edit-button",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",onClick:t}),o.a.createElement("p",{className:"profile__caption"},f)),o.a.createElement("button",{className:"profile__add-button",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:n})),o.a.createElement("section",{className:"elements","aria-label":"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u043c\u0435\u0441\u0442 \u0420\u043e\u0441\u0441\u0438\u0438"},o.a.createElement("ul",{className:"elements__list"},v.map((function(e){return o.a.createElement(_,{card:e,onCardClick:l,onCardLike:u,onCardDelete:r,onSelectDeleteCard:i,onDeletePopup:r,onImageOpen:c,key:e._id})})))))};var h=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2023 \u041a\u0443\u0437\u043d\u0435\u0446\u043e\u0432 \u041c\u0438\u0445\u0430\u0438\u043b"))};var v=function(e){var t=e.card,n=e.onClose,a=e.onOverlayClick;return o.a.createElement("div",{className:"popup image-popup ".concat(t.link?"popup_opened":""),onClick:a},o.a.createElement("figure",{className:"image-popup__figure"},o.a.createElement("button",{className:"popup__close-button image-popup__close-button",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:n}),o.a.createElement("img",{src:t.link,alt:t.name,className:"image-popup__image"}),o.a.createElement("figcaption",{className:"image-popup__caption"},t.name)))},E=n(4),b=n(5),C={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inputErrorSelector:".popup__input-error_type_",inputErrorFrameClass:"popup__input_error-frame"},g={},k=new(function(){function e(t){var n=t.url,a=t.headers;Object(E.a)(this,e),this._url=n,this._headers=a}return Object(b.a)(e,[{key:"_getRequest",value:function(e,t){return fetch(e,t).then((function(e){return e.ok?e.json():e.json().then((function(t){var n=t.message||"Request failed",a=new Error(n);throw a.status=e.status,a}))}))}},{key:"getUserInfo",value:function(){return this._getRequest("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers})}},{key:"setUserInfo",value:function(e){return this._getRequest("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}},{key:"changeAvatar",value:function(e){var t=e.avatar;return this._getRequest("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})})}},{key:"getInitialCards",value:function(){return this._getRequest("".concat(this._url,"/cards"),{method:"GET",headers:this._headers})}},{key:"createCard",value:function(e){return this._getRequest("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)})}},{key:"deleteCard",value:function(e){return this._getRequest("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}},{key:"setlike",value:function(e,t){return t?this._getRequest("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers}):this._getRequest("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers})}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-76",headers:{authorization:"879fc354-cfc1-42a1-b8be-cb6ca897d345","Content-Type":"application/json"}});var y=function(e){var t=e.name,n=e.title,a=e.button,r=e.children,i=e.isOpen,c=e.onClose,l=e.onSubmit,u=e.onLoading,s=e.onOverlayClick;return o.a.createElement("div",{className:"popup ".concat(i?"popup_opened":""),onClick:s},o.a.createElement("div",{className:"popup__container ".concat(t,"-popup__container")},o.a.createElement("button",{className:"popup__close-button",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:c}),o.a.createElement("h2",{className:"popup__title"},n),o.a.createElement("form",{name:t,className:"popup__form ".concat(t,"-popup__form"),onSubmit:l,noValidate:!0},r,o.a.createElement("button",{className:"popup__button ".concat(t,"-popup__button"),type:"submit"},u?"C\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":a||"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))};var O=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,r=e.onLoading,i=e.onOverlayClick,c=o.a.useContext(m),u=o.a.useState(""),s=Object(l.a)(u,2),p=s[0],_=s[1],d=o.a.useState(""),f=Object(l.a)(d,2),h=f[0],v=f[1];return o.a.useEffect((function(){c&&(_(c.name),v(c.about))}),[c,t]),o.a.createElement(y,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onLoading:r,onSubmit:function(e){e.preventDefault(),a({name:p,about:h})},onOverlayClick:i},o.a.createElement("div",{className:"popup__form-wrapper"},o.a.createElement("input",{name:"name",minLength:2,maxLength:40,type:"text",id:"nameInput",className:"popup__input popup__input_type_name",required:"",value:null!==p&&void 0!==p?p:"",onChange:function(e){_(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error popup__input-error_type_name",id:"nameInput-error"})),o.a.createElement("div",{className:"popup__form-wrapper"},o.a.createElement("input",{name:"job",minLength:2,maxLength:200,type:"text",id:"about",className:"popup__input popup__input_type_job",required:"",value:null!==h&&void 0!==h?h:"",onChange:function(e){v(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error popup__input-error_type_job",id:"about-error"})))};var S=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,r=e.onLoading,i=e.onOverlayClick,c=o.a.useRef();return o.a.useEffect((function(){t&&(c.current.value="")}),[t]),o.a.createElement(y,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onLoading:r,onSubmit:function(e){e.preventDefault(),a({avatar:c.current.value})},onOverlayClick:i},o.a.createElement("div",{className:"popup__form-wrapper"},o.a.createElement("input",{name:"avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",type:"url",id:"avatar-link",className:"popup__input popup__input_type_link",required:"",ref:c}),o.a.createElement("span",{className:"popup__input-error popup__input-error_type_avatar-link",id:"avatar-link-error"})))};var N=function(e){var t=e.isOpen,n=e.onClose,a=e.onAddCard,r=e.onLoading,i=e.onOverlayClick,c=o.a.useState(""),u=Object(l.a)(c,2),s=u[0],p=u[1],m=o.a.useState(""),_=Object(l.a)(m,2),d=_[0],f=_[1];return o.a.useEffect((function(){t&&(p(""),f(""))}),[t]),o.a.createElement(y,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",button:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:n,onLoading:r,onSubmit:function(e){e.preventDefault(),a({name:s,link:d})},onOverlayClick:i},o.a.createElement("div",{className:"popup__form-wrapper"},o.a.createElement("input",{name:"place",minLength:2,maxLength:30,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",type:"text",id:"name",className:"popup__input popup__input_type_place",required:"",value:null!==s&&void 0!==s?s:"",onChange:function(e){p(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error popup__input-error_type_place",id:"name-error"})),o.a.createElement("div",{className:"popup__form-wrapper"},o.a.createElement("input",{name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",type:"url",id:"link",className:"popup__input popup__input_type_link",required:"",value:null!==d&&void 0!==d?d:"",onChange:function(e){f(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error popup__input-error_type_link",id:"link-error"})))};var j=function(e){var t=e.isOpen,n=e.onClose,a=e.onDeleteCard,r=e.card,i=e.onLoading,c=e.onOverlayClick;return o.a.createElement(y,{name:"delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",button:"\u0414\u0430",isOpen:t,onClose:n,onLoading:i,onSubmit:function(e){e.preventDefault(),a(r)},onOverlayClick:c})},L=function(){function e(t,n){Object(E.a)(this,e),this._form=n,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inputErrorSelector=t.inputErrorSelector,this._inputErrorFrameClass=t.inputErrorFrameClass,this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector))}return Object(b.a)(e,[{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_showInputError",value:function(e){this._form.querySelector("".concat(this._inputErrorSelector).concat(e.name)).textContent=e.validationMessage,e.classList.add(this._inputErrorFrameClass)}},{key:"_hideInputError",value:function(e){this._form.querySelector("".concat(this._inputErrorSelector).concat(e.name)).textContent="",e.classList.remove(this._inputErrorFrameClass)}},{key:"setButtonState",value:function(e){e?this._buttonElement.removeAttribute("disabled"):this._buttonElement.setAttribute("disabled",!0)}},{key:"_preventDefault",value:function(e){e.preventDefault()}},{key:"_setEventListeners",value:function(){var e=this;this._form.addEventListener("submit",(function(t){e.setButtonState(!1),e._preventDefault(t)})),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._form.checkValidity()?e.setButtonState(!0):e.setButtonState(!1)}))}))}},{key:"resetValidation",value:function(){var e=this;this.setButtonState(!1),this._inputList.forEach((function(t){e._hideInputError(t)}))}},{key:"startValidate",value:function(){this._setEventListeners()}}]),e}(),w=function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=new L(e,t),a=t.getAttribute("name");g[a]=n,n.startValidate()}(e,t)}))};var D=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(!1),u=Object(l.a)(i,2),s=u[0],_=u[1],E=Object(a.useState)(!1),b=Object(l.a)(E,2),y=b[0],D=b[1],I=Object(a.useState)(!1),q=Object(l.a)(I,2),A=q[0],P=q[1],x=Object(a.useState)(!1),B=Object(l.a)(x,2),R=B[0],T=B[1],U=Object(a.useState)([]),F=Object(l.a)(U,2),V=F[0],J=F[1],G=Object(a.useState)([]),H=Object(l.a)(G,2),M=H[0],z=H[1],K=Object(a.useState)({}),Q=Object(l.a)(K,2),W=Q[0],X=Q[1],Y=Object(a.useState)([]),Z=Object(l.a)(Y,2),$=Z[0],ee=Z[1],te=Object(a.useState)(!1),ne=Object(l.a)(te,2),ae=ne[0],oe=ne[1],re=function(e){e.target===e.currentTarget&&ce()},ie=Object(a.useCallback)((function(e){for(var t in e)e.hasOwnProperty(t)&&e[t]instanceof L&&e[t].resetValidation()}),[]),ce=Object(a.useCallback)((function(){D(!1),r(!1),_(!1),P(!1),J([]),z([]),ie(g),g.delete.setButtonState(!0)}),[D,r,_,P,J,z,ie]);function le(){oe(!0)}function ue(){oe(!1)}return Object(a.useEffect)((function(){w(C);var e=function(e){(n||s||y||A||R)&&"Escape"===e.key&&ce()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[n,s,y,A,R,ce]),Object(a.useEffect)((function(){k.getUserInfo().then((function(e){X(e)})).catch((function(e){console.log(e)})),k.getInitialCards().then((function(e){ee(e)})).catch((function(e){console.log(e)}))}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement(m.Provider,{value:W},o.a.createElement(d.Provider,{value:$},o.a.createElement("div",{className:"page__container"},o.a.createElement(p,null),o.a.createElement(f,{onEditProfile:function(){r(!0)},onAddPlace:function(){_(!0)},onEditAvatar:function(){D(!0)},onDeletePopup:function(){P(!0)},onSelectDeleteCard:z,onImageOpen:function(){T(!0)},onCardClick:J,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===W._id}));k.setlike(e._id,!t).then((function(t){ee((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))}}),o.a.createElement(h,null)),o.a.createElement(O,{isOpen:n,onClose:ce,onUpdateUser:function(e){le(),k.setUserInfo(e).then((function(e){X(e),ce()})).catch((function(e){console.log(e)})).finally((function(){ue()}))},onLoading:ae,onOverlayClick:re}),o.a.createElement(N,{isOpen:s,onClose:ce,onAddCard:function(e){le(),k.createCard(e).then((function(e){ee([e].concat(Object(c.a)($))),ce()})).catch((function(e){console.log(e)})).finally((function(){ue()}))},onLoading:ae,onOverlayClick:re}),o.a.createElement(v,{card:V,onClose:ce,onOverlayClick:re}),o.a.createElement(j,{isOpen:A,onClose:ce,onDeleteCard:function(e){le(),k.deleteCard(e._id).then((function(){ee((function(t){return t.filter((function(t){return t._id!==e._id}))})),ce(),g.delete.setButtonState(!0)})).catch((function(e){console.log(e)})).finally((function(){ue()}))},card:M,onLoading:ae,onOverlayClick:re}),o.a.createElement(S,{isOpen:y,onClose:ce,onUpdateAvatar:function(e){le(),k.changeAvatar(e).then((function(e){X(e),ce()})).catch((function(e){console.log(e)})).finally((function(){ue()}))},onLoading:ae,onOverlayClick:re}))))},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),r(e),i(e)}))};i.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(D,null))),I()},7:function(e,t,n){},9:function(e,t,n){e.exports=n.p+"static/media/header-logo.4e5bdbab.svg"}},[[11,1,2]]]);
//# sourceMappingURL=main.8053c26e.chunk.js.map